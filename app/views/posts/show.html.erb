<% provide(:page_title, @post.title) %>

<div class="card">
	<div class="col-md-10 col-md-offset-2 col-lg-8 col-lg-offset-2">
		<h1 class="text-center"><%= @post.title %></h1>
		<p class="text-center"><small>
			<%= @post.display_day_published %> | <%= @post.user.email %>
		</small></p>
		<p class="text-justify"><%= @post.body %></p>
		<div class="pull-right">
		<% if user_signed_in? && current_user == @post.user %>
			<%= link_to 'Edit', edit_post_path(@post), class:'btn btn-primary' %>
			<%= link_to "Delete", post_path(@post), method: :delete, 
			data: { confirm: "Are you sure you want to delete this post?" }, 
			class: "btn btn-danger btn-space" %>
		<% end %>
			<%= link_to 'Back', posts_path, class:'btn btn-primary' %>		
		</div>
	</div>
</div>
<div class="col-md-12">
  <%= form_for [@post, @comment],
      :html => {class: "form-horizontal", role: "form"} do |f| %>
    <% if @comment.errors.any? %>
      <div class='panel panel-danger col-md-offset-1'>
        <div class='panel-heading'>
          <h2 class='panel-title'>
            <%= pluralize(@comment.errors.count, "error") %>
            prohibited this comment from being saved:
          </h2>
          <div class='panel-body'>
            <ul>
              <% @comment.errors.full_messages.each do |msg| %>
                <li><%= msg %></li>
              <% end %>  
            </ul>
          </div>
        </div>
      </div>
    <% end %>
	<div class="form-group">
		<h3>
			<%= f.label :body, 'LEAVE A COMMENT' %>
		</h3>
		<div class="col-md-12">
			<%= f.text_area :body, rows: 10, class: 'form-control', placeholder: 'Your comment' %> 
		</div>
	</div>
	<div class="form-group float-left">
		<div class="element">
			<%= f.submit "Add Comment", class: 'btn btn-primary btn-lg' %> 
		</div>
	</div>
  <% end %>	
</div>
<div class="list-groups">
	<h2>Comments</h2>
	<div class="list-group-item">
		<div class="row-content">
			<% if @post.comments.any? %>
				<% persisted_comments(@comments).each do |comment| %>
					<div class="least-content">
						<small><%= time_ago_in_words(comment.created_at) %>
						 ago by <%= comment.user.email %></small>
					</div>
					<p class="list-group-item-text">
						<%= comment.body %>
					</p>
					<hr>
				<% end %>
			<% else %>
				<p class="list-group-item-text">
					There are no comments to show.
				</p>
			<% end %>
		</div>
	</div>
</div>
